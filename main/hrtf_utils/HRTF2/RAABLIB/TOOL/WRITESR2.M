function writesr2(filename,hl,hr);
% WRITESR2 writes SR2 file with given filename, data hl for left channel
%          and data hr for right channel.
%          WRITESR2(filename,hl,hr);

% (c) Lehrstuhl fuer allgemeine Elektrotechnik und Akustik
% Ruhr-Universitaet Bochum
% (p) 15.10.1994 A. Raab

nl=length(hl);
nr=length(hr);
if nl<1024
  disp('warning: left data vector filled up with zeros');
  hl=[hl(:) zeros(1024-nl,1)];
end;
if nr<1024
  disp('warning: right data vector filled up with zeros');
  hr=[hr(:) zeros(1024-nr,1)];
end;
if nl>1024
  disp('warning: left data vector truncated to length 1024');
  hl=hl(1:1024);
end;
if nr>1024
  disp('warning: right data vector truncated to length 1024');
  hr=hr(1:1024);
end;

sr2header=...
  [ 32   100    97   116    97    32   115    97   109   112   108   101 ...
   100    32    98   121    32   111   117   116    95   105   110     0 ...
     1     0    71    26   130    14   183     1     2    24     1     0 ...
   136    14   140    26     1     0    71    26    71    10   148    14 ...
    65     2     2    24    10     0    22     0    42    26    71    26 ...
    23     0   252     2    76    15   137     0    49    24    22     0 ...
    42    26    23     0    17    15   140    26     2     0     1     0 ...
     2     0    19     0     8     0    94     0    16     0     0     0 ...
   255   255    48     0     9    15   103   128   255   255   255   255 ...
   135     0     0     0   248     2     1    51    46    52    52    48 ...
    50    50     0     2   234    25    32   114     0     4     0     0 ...
     0    68    44    71     0     0     0     0     0    68   172    70 ...
     0     0     0     0     1     0     0     0    14     0     0     0 ...
     0     0   128    63     0     0   128    63     0     0   128    63 ...
     0     0   128    63     0     0   128    63     0     0   128    63 ...
     0     0   128    63     0     0   128    63     0     0   128    63 ...
     0     0   128    63     0     0   128    63     0     0   128    63 ...
     0     0   128    63     0     0   128    63     0     0   128    63 ...
     0     0   128    63   185    69   218   177     1     0     0     0 ...
   159    44   220    61     0     0   192   235   139    60   219   146 ...
   155    22    98   255   239    63     8     0   100    15    56     0 ...
   255    23   118    15];

[fid,msg]=fopen(filename,'w','ieee-le');
if fid<0 error(msg); end;
fwrite(fid,sr2header,'char');
fwrite(fid,hl,'float32');
fwrite(fid,hr,'float32');
fclose(fid);
