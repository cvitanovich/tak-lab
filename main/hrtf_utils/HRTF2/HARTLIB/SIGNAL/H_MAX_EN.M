function [hout,t]=h_max_en(h,N)
% H_MAX_EN A rectangular window of length N is shifted over
%          the impulse response h and the energy inside the
%          window is computed as a function of the start
%          position of the window. The point t where the energy
%          the first time becomes a maximum is detected.
%          A modified impulse response hout is generated by ignoring
%          all samples in front of that point.
%          [hout,t]=H_MAX_EN(h,N)

% (c) Lehrstuhl fuer allgemeine Elektrotechnik und Akustik
% Ruhr-Universitaet Bochum
% (p) 29.09.1994 A. Raab

e=winenerg(h,N);       % compute energy inside window
[x,t]=max(e);          % t is the position of energy maxima
hout=h(t:length(h));   % modified response
